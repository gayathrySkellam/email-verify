"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8248],{5353:function(e,l,r){var s=r(5893),i=r(7294),n=r(3582),a=r(6264),o=r(5202),t=r(9655);let d={otp:0};l.Z=e=>{let{user:l,authType:r,handleSuccess:c,token:u,storeId:m}=e,[p,h]=(0,i.useState)([{label:"OTP",fieldname:"otp",placeholder:"****",value:"",id:5,keyboardType:"password",isPassword:!0,isPasswordVisible:!1,error:null,isRequired:!0,emptyErrorMessage:"OTP is required. Please provide the OTP.",inputWidthSize:"12"}]),[b,g]=(0,i.useState)(!1),[y,f]=(0,i.useState)(!1),[v,x]=(0,i.useState)(30),[w,P]=(0,i.useState)(null),[N,q]=(0,i.useState)(2),[k,j]=(0,i.useState)(null),[E,C]=(0,i.useState)(!1),{apiPost:O}=(0,t.kL)(),I=(e,l)=>{let r=[...p];r[l].value=e,r[l].error=null,h(r)},L=e=>{let l=[...p],r=p[e].isPasswordVisible;l[e].keyboardType=r?"password":"default",l[e].isPasswordVisible=!r,h(l)},T=e=>!!e&&/^\d+$/.test(e),S=async()=>{let e=p[d.otp].value.trim();if(T(e)&&4===e.length){var s,i,n,a;let t;j(null),C(!0);let d="".concat(o.kh.qfferAPI,"/customer/web/signUp/email/").concat(m,"?otp=").concat(e),p=JSON.stringify(l);"PROFILE"===r?(d="".concat(o.kh.qfferAPI,"/customer/web/email/verify/").concat(e),p=JSON.stringify({value:null})):"LOGIN"===r&&(d="".concat(o.kh.qubriuxAPI,"/store/").concat(m,"/customer/login/verifyOTPAndLogin?otp=").concat(e),p=JSON.stringify({email:l.email?l.email:null,phoneNumber:l.phone?l.phone:null,storeId:m}));try{t="PROFILE"===r?await O(d,p,null,u):await O(d,p)}catch(e){j("Something went wrong! Please try again after some time."),C(!1)}(null===(i=t)||void 0===i?void 0:null===(s=i.message)||void 0===s?void 0:s.toLowerCase())==="success"?(console.log("response: ",t),c(t.body)):(null===(a=t)||void 0===a?void 0:null===(n=a.message)||void 0===n?void 0:n.toLowerCase())==="failure"&&t.body?j(t.body):j("Something went wrong! Please try again after some time."),C(!1)}else{let e=[...p];e[d.otp].error="Invalid OTP format. Please enter a valid OTP.",h(e)}},M=async()=>{let e;j(null);let s="".concat(o.kh.qfferAPI,"/customer/web/create/phone/verify"),i=JSON.stringify({value:l.phone});"PROFILE"===r?(s="".concat(o.kh.qfferAPI,"/customer/web/email/verify"),i=JSON.stringify({value:null})):"LOGIN"===r&&(s="".concat(o.kh.qubriuxAPI,"/store/").concat(m,"/customer/login/sendOTP"),i=JSON.stringify({email:l.email?l.email:null,phoneNumber:l.phone?l.phone:null,storeId:m}));try{e="PROFILE"===r?await O(s,i,null,u):await O(s,i)}catch(e){}console.log("response: ",e)},R=()=>{let e;try{e=setInterval(()=>{x(e=>e-1)},1e3),P(e),f(!1)}catch(l){clearInterval(e)}},A=()=>{let e=!0;return p.forEach(l=>{l.isRequired&&!l.value&&(e=!1)}),!e},H=(0,i.useMemo)(()=>A(),[p]);return(0,i.useEffect)(()=>{y&&R()},[y]),(0,i.useEffect)(()=>{1===v&&w?(clearInterval(w),g(!0)):30===v&&(f(!0),g(!1))},[v]),(0,s.jsxs)("form",{className:"qb-signup-form px-md-5 py-5 d-flex flex-column align-items-stretch",id:"qb-signupform",onSubmit:e=>{e.preventDefault()},children:[(0,s.jsx)("h3",{className:"qb-title mb-0 pb-2 qb-signup-title-text",children:"Verify user"}),(0,s.jsxs)("p",{className:"qb-description mb-0 pb-4",children:["Please enter the 4 digit OTP","PROFILE"===r?" sent to your email address":"".concat(l.phone?"  sent to ".concat(l.phone):""),"."]}),(0,s.jsx)("div",{className:"container-fluid px-0 pt-md-0",children:(0,s.jsxs)("div",{className:"row gy-3",children:[p.map((e,l)=>(0,s.jsx)("div",{className:"col-12 col-lg-".concat(e.inputWidthSize),children:(0,s.jsx)(n.Wz,{value:e.value,id:e.id,index:l,label:e.label,placeholder:e.placeholder,fieldname:e.fieldname,error:e.error,isRequired:e.isRequired,fieldType:e.keyboardType,isPassword:e.isPassword,showPassword:e.isPasswordVisible,isDisabled:e.isDisabled,onViewPassword:L,onChange:I})},"input-".concat(l))),(0,s.jsx)("div",{className:"col-12",children:(0,s.jsxs)("div",{className:"d-flex align-items-center qb-resend-wrap",children:[(0,s.jsx)("p",{className:"qb-tag pe-2 mb-0",children:"Didn’t receive OTP?"}),(0,s.jsxs)("a",{className:b&&N?"qb-link qb-resend-otp-link d-flex align-items-center":"qb-link qb-resend-otp-link d-flex align-items-center qb-link-disabled",onClick:()=>{b&&N>0?(x(30),q(e=>e-1),M()):0===N&&j("You've reached the maximum OTP resend attempts. Please try again later.")},children:["Resend OTP ",(0,s.jsx)("span",{className:"qb-counter-wrap ps-1",children:b?" (".concat(N," ").concat(1===N?"try":"tries"," remaining)"):" (".concat(v,"s)")})]})]})}),(null==k?void 0:k.length)?(0,s.jsx)("div",{className:"col-12",children:(0,s.jsx)("p",{className:"qb-input-error-message mt-1 qb-general-error qb-error-active",children:k})}):null,(0,s.jsx)("div",{className:"col-lg-12",children:(0,s.jsx)("div",{className:"w-100 pt-md-3 pt-3 d-flex flex-column flex-md-row align-items-stretch align-items-md-center justify-content-end",children:(0,s.jsx)(a.K,{id:"qb-profile-btn",isDisabled:H,isLoading:E,onDisabledClick:()=>{let e=[...p];p.forEach((l,r)=>{l.isRequired&&!l.value&&(e[r].error=l.emptyErrorMessage?l.emptyErrorMessage:"Required field. Please fill this field to continue.")}),h([...e])},onClick:S,children:(0,s.jsxs)(s.Fragment,{children:["Verify",(0,s.jsx)("span",{className:"qb-btn-loader ms-2"})]})})})})]})})]})}},5785:function(e,l,r){var s=r(5893),i=r(7294),n=r(3582),a=r(6264),o=r(5202),t=r(9655),d=r(1664),c=r.n(d);let u={user:0},m=[{type:"EMAIL",name:"Email"},{type:"PHONE",name:"Phone"}];l.Z=e=>{let{storeId:l,handleSuccess:r,signupUrl:d,loginUrl:p,isForgotPassword:h,isUSNumber:b}=e,[g,y]=(0,i.useState)([{label:"Email/ Phone number",fieldname:"email",placeholder:"Email or phone number",value:"",id:2,keyboardType:"default",error:null,isRequired:!0,emptyErrorMessage:"Email or phone number is required. Please provide your email address or phone number.",inputWidthSize:"12"}]),[f,v]=(0,i.useState)(null),[x,w]=(0,i.useState)(!1),[P,N]=(0,i.useState)(null),{apiPost:q}=(0,t.kL)(),{emailValidation:k,phoneValidation:j,returnErrorTexts:E}=(0,t.V$)(),C=(e,l)=>{let r=[...g];r[l].value=e,r[l].error=null,y(r)},O=(e,l)=>{let r=[...g];r[l].countryCode="+".concat(e.code),r[l].countryCodeValue=e.code,y(r)},I=e=>{let l=e.type;"EMAIL"===l?y([{label:"Email",fieldname:"email",placeholder:"abott@company.org",value:"",id:2,keyboardType:"email",error:null,isRequired:!0,emptyErrorMessage:"Email is required. Please provide your email address.",inputWidthSize:"12"}]):b?y([{label:"Phone number",fieldname:"phone",placeholder:"9999 999 999",value:"",id:2,keyboardType:"phone",error:null,isRequired:!0,countryCode:"+1",countryCodeValue:"1",countryCodePlaceholder:"+1",inputFieldType:"PHONE",emptyErrorMessage:"Phone number is required. Please provide your phone number.",inputWidthSize:"12"}]):y([{label:"Phone number",fieldname:"phone",placeholder:"9999 999 999",value:"",id:2,keyboardType:"phone",error:null,isRequired:!0,countryCode:"+91",countryCodeValue:"91",countryCodePlaceholder:"+91",inputFieldType:"PHONE",emptyErrorMessage:"Phone number is required. Please provide your phone number.",inputWidthSize:"12"}]),N(l)},L=async e=>"PHONE"===P?await j(e)?{type:"PHONE",userId:e,userError:!1}:{type:"PHONE",userId:e,userError:!0}:await k(e)?{type:"EMAIL",userId:e,userError:!1}:{type:"EMAIL",userId:e,userError:!0},T=async()=>{console.log("IN");let{type:e,userId:s,userError:i}=await L(g[u.user].value);if(!i&&l){var n,a,t,d;let i;v(null),w(!0);let c="".concat(o.kh.qubriuxAPI,"/store/").concat(l,"/customer/login/sendOTP"),m=JSON.stringify({email:"EMAIL"===e?s:null,phoneNumber:"PHONE"===e?"".concat(g[u.user].countryCodeValue).concat(s):null,storeId:l});try{i=await q(c,m)}catch(e){v("Something went wrong! Please try again after some time."),w(!1)}(null===(n=i)||void 0===n?void 0:n.message)&&(null===(a=i)||void 0===a?void 0:a.message.toLowerCase())==="success"?(console.log("response: ",i.body),r({email:"EMAIL"===e?s:null,phone:"PHONE"===e?"".concat(g[u.user].countryCodeValue).concat(s):null})):((null===(t=i)||void 0===t?void 0:t.message)&&(null===(d=i)||void 0===d?void 0:d.message.toLowerCase())==="failure"&&i.body?v(i.body):v("Something went wrong! Please try again after some time."),w(!1))}else{let r=[...g];"EMAIL"===e&&i?r[u.user].error=await E(s,"email"):"PHONE"===e&&i&&(r[u.user].error=await E(s,"phone")),l||v("This link seems to be expired or broken, Please try again with another link."),y(r)}},S=()=>{let e=!0;return g.forEach(l=>{l.isRequired&&!l.value&&(e=!1)}),!e},M=(0,i.useMemo)(()=>S(),[g]);return(0,s.jsxs)("form",{className:"qb-signup-form px-md-5 py-5 d-flex flex-column align-items-stretch",id:"qb-signupform",children:[(0,s.jsx)("h3",{className:"qb-title mb-0 pb-2 qb-signup-title-text",children:h?"Forgot Password":"Login with OTP"}),(0,s.jsx)("p",{className:"qb-desc mb-0 pb-4",children:h&&P&&"EMAIL"===P?"Use your registered email id to reset your password.":h&&P&&"PHONE"===P?"Use your registered phone number to reset your password.":!P&&h?"Reset your password using a one time password. How do you wish to receive OTP, Email or phone number?":P&&"EMAIL"===P?"Use your registered email id to login using OTP.":P&&"PHONE"===P?"Use your registered phone number to login using OTP.":"How do you wish to receive OTP, Email or phone number?"}),(0,s.jsx)("div",{className:"container-fluid px-0 pt-md-0",children:(0,s.jsxs)("div",{className:"row gy-3",children:[m.map((e,l)=>(0,s.jsx)("div",{className:"col-sm-6",children:(0,s.jsxs)("div",{className:P&&P===e.type?"w-100 px-3 py-4 qb-user-input-selector d-flex align-items-center qb-user-input-active":"w-100 px-3 py-4 qb-user-input-selector d-flex align-items-center",onClick:()=>I(e),children:["EMAIL"===e.type?(0,s.jsxs)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("path",{d:"M28 7L16 18L4 7",stroke:"black","stroke-width":"1.2","stroke-linecap":"round","stroke-linejoin":"round"}),(0,s.jsx)("path",{d:"M4 7H28V24C28 24.2652 27.8946 24.5196 27.7071 24.7071C27.5196 24.8946 27.2652 25 27 25H5C4.73478 25 4.48043 24.8946 4.29289 24.7071C4.10536 24.5196 4 24.2652 4 24V7Z",stroke:"black","stroke-width":"1.2","stroke-linecap":"round","stroke-linejoin":"round"}),(0,s.jsx)("path",{d:"M13.8125 16L4.3125 24.7125",stroke:"black","stroke-width":"1.2","stroke-linecap":"round","stroke-linejoin":"round"}),(0,s.jsx)("path",{d:"M27.6875 24.7125L18.1875 16",stroke:"black","stroke-width":"1.2","stroke-linecap":"round","stroke-linejoin":"round"})]}):"PHONE"===e.type?(0,s.jsx)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M11.5625 15.6C12.5915 17.7251 14.3098 19.439 16.4375 20.4625C16.5944 20.5369 16.768 20.569 16.9412 20.5559C17.1143 20.5427 17.2811 20.4847 17.425 20.3875L20.55 18.3C20.6881 18.2064 20.8476 18.1493 21.0137 18.134C21.1799 18.1187 21.3471 18.1457 21.5 18.2125L27.35 20.725C27.5499 20.8083 27.717 20.9549 27.8254 21.1424C27.9338 21.3298 27.9776 21.5477 27.95 21.7625C27.7646 23.2097 27.0582 24.5397 25.9631 25.5038C24.8679 26.4678 23.459 26.9997 22 27C17.4913 27 13.1673 25.209 9.97918 22.0209C6.79107 18.8327 5 14.5087 5 10C5.00033 8.54104 5.53227 7.13214 6.49628 6.03699C7.4603 4.94183 8.79033 4.23546 10.2375 4.05004C10.4523 4.02245 10.6702 4.06623 10.8577 4.17465C11.0452 4.28307 11.1918 4.4501 11.275 4.65004L13.7875 10.5125C13.8528 10.663 13.8802 10.8272 13.8671 10.9907C13.854 11.1541 13.8009 11.3119 13.7125 11.45L11.625 14.625C11.5321 14.7686 11.4775 14.9337 11.4666 15.1044C11.4556 15.2751 11.4887 15.4457 11.5625 15.6V15.6Z",stroke:"black","stroke-width":"1.2","stroke-linecap":"round","stroke-linejoin":"round"})}):null,(0,s.jsx)("h6",{className:"qb-user-input-option mb-0 ps-1",children:e.name})]})},"input-option-".concat(l))),P?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"col-12"}),g.map((e,l)=>e.isInputHidden?null:(0,s.jsx)("div",{className:"col-12 col-lg-".concat(e.inputWidthSize),children:e.inputFieldType&&"PHONE"===e.inputFieldType?(0,s.jsx)(n.sb,{value:e.value,id:e.id,index:l,label:e.label,placeholder:e.placeholder,fieldname:e.fieldname,error:e.error,isRequired:e.isRequired,countryCode:e.countryCode,codePlaceholder:e.countryCodePlaceholder,isDisabled:e.isDisabled,onCountryCodeSelect:O,onChange:C}):(0,s.jsx)(n.Wz,{value:e.value,id:e.id,index:l,label:e.label,placeholder:e.placeholder,fieldname:e.fieldname,error:e.error,isRequired:e.isRequired,fieldType:e.keyboardType,isDisabled:e.isDisabled,onChange:C})},"input-".concat(l)))]}):null,(null==f?void 0:f.length)?(0,s.jsx)("div",{className:"col-12",children:(0,s.jsx)("p",{className:"qb-input-error-message mt-1 qb-general-error qb-error-active",children:f})}):null,(0,s.jsx)("div",{className:"col-lg-12",children:(0,s.jsxs)("div",{className:"w-100 pt-md-3 pt-3 d-flex align-items-center justify-content-end",children:[h?null:(0,s.jsx)("div",{className:"pe-4 d-flex align-items-center",children:(0,s.jsx)(c(),{href:p,className:"qb-link",children:"Login using password"})}),(0,s.jsx)("div",{className:"d-flex",children:(0,s.jsx)(a.K,{id:"qb-profile-btn",isDisabled:M,isLoading:x,onDisabledClick:()=>{let e=[...g];g.forEach((l,r)=>{l.isRequired&&!l.value&&(e[r].error=l.emptyErrorMessage?l.emptyErrorMessage:"Required field. Please fill this field to continue.")}),y([...e])},onClick:T,children:(0,s.jsxs)(s.Fragment,{children:["Get OTP",(0,s.jsx)("span",{className:"qb-btn-loader ms-2"})]})})})]})}),(0,s.jsx)("div",{className:"col-12",children:(0,s.jsx)("div",{className:"w-100 flex-column align-items-center align-items-md-end d-flex",children:d&&!h?(0,s.jsxs)("p",{className:"qb-description",children:["Don’t have an account? ",(0,s.jsx)(c(),{href:d,className:"qb-link",children:"Signup"})]}):h?(0,s.jsxs)("p",{className:"qb-description",children:["Try logging in? ",(0,s.jsx)(c(),{href:p,className:"qb-link",children:"Login"})]}):null})})]})})]})}}}]);