(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5613],{6700:function(e,l,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/auth/signup",function(){return a(7322)}])},5494:function(e,l){"use strict";l.Z={src:"/_next/static/media/general.7095fc5d.png",height:506,width:500,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAxUlEQVR42mPABX6UNDP+a21nhAt8K29n/5zTovGtqFX3Z207N1zieWgHE4j+mNtm/qG0x/N7cbPW9/JWh9/1bVJ/G9uEwYreJ7WJfMjvjXhX3Jn+PrvJ5H99P/+fhnaNP41tSgwvPKpE38R3ur0vnxT3oayt/ENVQ8WnjnLjX+2NKv+bujgZXgY0sL6JbBL8kNth+LmizfZLXaPdl+Zam58tDZIYLn9TO5X9TXs9O4z/pbUK4ou38W2MH9PyGVG82dIA5gMAcORU4v0N6lsAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8}},7936:function(e,l){"use strict";l.Z={src:"/_next/static/media/success_anime.43cd7380.gif",height:674,width:674,blurWidth:0,blurHeight:0}},2688:function(e,l,a){"use strict";var i=a(5893);a(7294);var r=a(511),t=a(5675),s=a.n(t),n=a(7936);l.Z=e=>{let{isVisible:l,handleBackdropClick:a,title:t,message:o,isQffer:d}=e;return(0,i.jsx)(r.Z,{isVisible:l,handleBackdropClick:a,children:(0,i.jsxs)("div",{className:"w-100 p-5 d-flex align-items-center flex-column",children:[(0,i.jsx)("div",{className:"qb-popup-illustration-wrapper pb-3 w-100 d-flex align-items-center justify-content-center",children:(0,i.jsx)(s(),{src:n.Z,alt:"success",className:"qb-popup-illustration"})}),(0,i.jsx)("h3",{className:"qb-title mb-0 pb-3 pt-5",children:t}),(0,i.jsx)("p",{className:"qb-description mb-0 pb-4",children:o}),d?(0,i.jsx)("div",{className:"w-100 pt-md-3 pt-3 d-flex flex-column flex-md-row align-items-stretch align-items-md-center justify-content-center",children:(0,i.jsx)("a",{className:"qb-btn qb-primary-btn qb-link-btn",type:"button",href:"https://shop.qffer.in/download",children:"Download Qffer"})}):null]})})}},511:function(e,l,a){"use strict";var i=a(5893),r=a(7294);l.Z=e=>{let{children:l,isVisible:a,handleBackdropClick:t,isLarge:s}=e,[n,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)(!1),u=()=>{o(!0),setTimeout(()=>{c(!0)},400)},p=()=>{c(!1),setTimeout(()=>{o(!1)},400)};return(0,r.useEffect)(()=>{a?u():n&&p()},[a]),(0,i.jsx)("div",{className:n?"qb-modal-wrapper position-fixed":"qb-modal-wrapper position-fixed d-none",onClick:t,children:(0,i.jsx)("div",{className:d?"qb-modal-wrap  qb-modal-active":"qb-modal-wrap",children:(0,i.jsx)("div",{className:s?"qb-modal-large qb-modal-dialog-wrapper position-relative":"qb-modal-dialog-wrapper position-relative",children:(0,i.jsx)("div",{className:"qb-modal-dialog position-absolute d-flex align-items-stretch justify-content-center position-absolute",onClick:e=>{e.stopPropagation()},children:l})})})})}},6775:function(e,l,a){"use strict";var i=a(5893);a(7294);var r=a(511),t=a(5675),s=a.n(t),n=a(5494);l.Z=e=>{let{isVisible:l,handleBackdropClick:a,title:t,message:o}=e;return(0,i.jsx)(r.Z,{isVisible:l,handleBackdropClick:a,children:(0,i.jsxs)("div",{className:"w-100 p-5",children:[(0,i.jsx)("div",{className:"qb-popup-illustration-wrapper pb-3 w-100 d-flex align-items-center justify-content-center",children:(0,i.jsx)(s(),{src:n.Z,alt:"success",className:"qb-popup-illustration"})}),(0,i.jsx)("h3",{className:"qb-title mb-0 pb-3 pt-5",children:t}),(0,i.jsx)("p",{className:"qb-description mb-0 pb-4",children:o})]})})}},5353:function(e,l,a){"use strict";var i=a(5893),r=a(7294),t=a(3582),s=a(6264),n=a(5202),o=a(9655);let d={otp:0};l.Z=e=>{let{user:l,authType:a,handleSuccess:c,token:u,storeId:p}=e,[m,h]=(0,r.useState)([{label:"OTP",fieldname:"otp",placeholder:"****",value:"",id:5,keyboardType:"password",isPassword:!0,isPasswordVisible:!1,error:null,isRequired:!0,emptyErrorMessage:"OTP is required. Please provide the OTP.",inputWidthSize:"12"}]),[b,f]=(0,r.useState)(!1),[v,y]=(0,r.useState)(!1),[g,w]=(0,r.useState)(30),[x,q]=(0,r.useState)(null),[N,P]=(0,r.useState)(2),[j,S]=(0,r.useState)(null),[k,T]=(0,r.useState)(!1),{apiPost:C}=(0,o.kL)(),E=(e,l)=>{let a=[...m];a[l].value=e,a[l].error=null,h(a)},R=e=>{let l=[...m],a=m[e].isPasswordVisible;l[e].keyboardType=a?"password":"default",l[e].isPasswordVisible=!a,h(l)},L=e=>!!e&&/^\d+$/.test(e),O=async()=>{let e=m[d.otp].value.trim();if(L(e)&&4===e.length){var i,r,t,s;let o;S(null),T(!0);let d="".concat(n.kh.qubriuxAPI,"/store/").concat(l.storeId,"/customer/web/signUp/email?otp=").concat(e),m=JSON.stringify(l);"PROFILE"===a?(d="".concat(n.kh.qfferAPI,"/customer/web/email/verify/").concat(e),m=JSON.stringify({value:null})):"LOGIN"===a&&(d="".concat(n.kh.qubriuxAPI,"/store/").concat(p,"/customer/login/verifyOTPAndLogin?otp=").concat(e),m=JSON.stringify({email:l.email?l.email:null,phoneNumber:l.phone?l.phone:null,storeId:p}));try{o="PROFILE"===a?await C(d,m,null,u):await C(d,m)}catch(e){S("Something went wrong! Please try again after some time."),T(!1)}(null===(r=o)||void 0===r?void 0:null===(i=r.message)||void 0===i?void 0:i.toLowerCase())==="success"?(console.log("response: ",o),c(o.body)):(null===(s=o)||void 0===s?void 0:null===(t=s.message)||void 0===t?void 0:t.toLowerCase())==="failure"&&o.body?S(o.body):S("Something went wrong! Please try again after some time."),T(!1)}else{let e=[...m];e[d.otp].error="Invalid OTP format. Please enter a valid OTP.",h(e)}},I=async()=>{let e;S(null);let i="".concat(n.kh.qfferAPI,"/customer/web/create/phone/verify"),r=JSON.stringify({value:l.phone});"PROFILE"===a?(i="".concat(n.kh.qfferAPI,"/customer/web/email/verify"),r=JSON.stringify({value:null})):"LOGIN"===a&&(i="".concat(n.kh.qubriuxAPI,"/store/").concat(p,"/customer/login/sendOTP"),r=JSON.stringify({email:l.email?l.email:null,phoneNumber:l.phone?l.phone:null,storeId:p}));try{e="PROFILE"===a?await C(i,r,null,u):await C(i,r)}catch(e){}console.log("response: ",e)},A=()=>{let e;try{e=setInterval(()=>{w(e=>e-1)},1e3),q(e),y(!1)}catch(l){clearInterval(e)}},D=()=>{let e=!0;return m.forEach(l=>{l.isRequired&&!l.value&&(e=!1)}),!e},F=(0,r.useMemo)(()=>D(),[m]);return(0,r.useEffect)(()=>{v&&A()},[v]),(0,r.useEffect)(()=>{1===g&&x?(clearInterval(x),f(!0)):30===g&&(y(!0),f(!1))},[g]),(0,i.jsxs)("form",{className:"qb-signup-form px-md-5 py-5 d-flex flex-column align-items-stretch",id:"qb-signupform",onSubmit:e=>{e.preventDefault()},children:[(0,i.jsx)("h3",{className:"qb-title mb-0 pb-2 qb-signup-title-text",children:"Verify user"}),(0,i.jsxs)("p",{className:"qb-description mb-0 pb-4",children:["Please enter the 4 digit OTP","PROFILE"===a?" sent to your email address":"".concat(l.phone?"  sent to ".concat(l.phone):""),"."]}),(0,i.jsx)("div",{className:"container-fluid px-0 pt-md-0",children:(0,i.jsxs)("div",{className:"row gy-3",children:[m.map((e,l)=>(0,i.jsx)("div",{className:"col-12 col-lg-".concat(e.inputWidthSize),children:(0,i.jsx)(t.Wz,{value:e.value,id:e.id,index:l,label:e.label,placeholder:e.placeholder,fieldname:e.fieldname,error:e.error,isRequired:e.isRequired,fieldType:e.keyboardType,isPassword:e.isPassword,showPassword:e.isPasswordVisible,isDisabled:e.isDisabled,onViewPassword:R,onChange:E})},"input-".concat(l))),(0,i.jsx)("div",{className:"col-12",children:(0,i.jsxs)("div",{className:"d-flex align-items-center qb-resend-wrap",children:[(0,i.jsx)("p",{className:"qb-tag pe-2 mb-0",children:"Didnâ€™t receive OTP?"}),(0,i.jsxs)("a",{className:b&&N?"qb-link qb-resend-otp-link d-flex align-items-center":"qb-link qb-resend-otp-link d-flex align-items-center qb-link-disabled",onClick:()=>{b&&N>0?(w(30),P(e=>e-1),I()):0===N&&S("You've reached the maximum OTP resend attempts. Please try again later.")},children:["Resend OTP ",(0,i.jsx)("span",{className:"qb-counter-wrap ps-1",children:b?" (".concat(N," ").concat(1===N?"try":"tries"," remaining)"):" (".concat(g,"s)")})]})]})}),(null==j?void 0:j.length)?(0,i.jsx)("div",{className:"col-12",children:(0,i.jsx)("p",{className:"qb-input-error-message mt-1 qb-general-error qb-error-active",children:j})}):null,(0,i.jsx)("div",{className:"col-lg-12",children:(0,i.jsx)("div",{className:"w-100 pt-md-3 pt-3 d-flex flex-column flex-md-row align-items-stretch align-items-md-center justify-content-end",children:(0,i.jsx)(s.K,{id:"qb-profile-btn",isDisabled:F,isLoading:k,onDisabledClick:()=>{let e=[...m];m.forEach((l,a)=>{l.isRequired&&!l.value&&(e[a].error=l.emptyErrorMessage?l.emptyErrorMessage:"Required field. Please fill this field to continue.")}),h([...e])},onClick:O,children:(0,i.jsxs)(i.Fragment,{children:["Verify",(0,i.jsx)("span",{className:"qb-btn-loader ms-2"})]})})})})]})})]})}},7322:function(e,l,a){"use strict";a.r(l),a.d(l,{default:function(){return j}});var i=a(5893),r=a(7294),t=a(9008),s=a.n(t),n=a(1163),o=a(8295),d=a(3582),c=a(6264),u=a(5202),p=a(9655),m=a(1664),h=a.n(m);let b={name:0,email:1,phone:2,dob:3,gender:4,marital:5,anniversary:6,referral:7,checkBox:9,homelocation:8},f=[{label:"Male",value:"Male"},{label:"Female",value:"Female"},{label:"Prefer not to answer/other",value:"Prefer not to answer/other"}],v=[{label:"Single",value:"Single"},{label:"Married",value:"Married"},{label:"Prefer not to answer/other",value:"Prefer not to answer/other"}],y={"Phone numer is registered with a different email":"01","Email is already present":"02","You are already signed up":"03","Form already submitted":"04"},g={name:!0,email:!0,phone:!0,referral:!0};var w=e=>{var l;let{storeId:a,storeData:t,referral:s,navigateToOtp:n,loginUrl:o,redirectLink:m,handleRedirect:w,isQffer:x,storeListing:q}=e,[N,P]=(0,r.useState)([{label:"Name",fieldname:"name",placeholder:"John Doe",value:"",id:1,keyboardType:"default",error:null,isRequired:!0,emptyErrorMessage:"Name is required. Please provide your name.",inputWidthSize:"12"},{label:"Email",fieldname:"email",placeholder:"johndoe@company.com",value:"",id:2,keyboardType:"email",error:null,isRequired:!0,emptyErrorMessage:"Email is required. Please provide your email address.",inputWidthSize:"12"},{label:"Phone",fieldname:"phone",placeholder:"999 999 9999",value:"",id:3,keyboardType:"phone",error:null,isRequired:!0,countryCode:"+91",countryCodeValue:"91",countryCodePlaceholder:"+91",inputFieldType:"PHONE",emptyErrorMessage:"Phone number is required. Please provide your Phone number.",inputWidthSize:"12"},{label:"Date of birth",fieldname:"dob",placeholder:"dd/mm/yyyy",value:"",id:13,keyboardType:"date",error:null,isRequired:!1,emptyErrorMessage:"Date of birth is required. Please provide your birth date.",inputWidthSize:"6"},{label:"Gender",fieldname:"gender",placeholder:"Select",value:"",id:14,keyboardType:"default",error:null,isRequired:!1,inputFieldType:"SELECT",isDropdownOpen:!1,selectBoxType:"gender",emptyErrorMessage:"Gender is required. Please provide your gender.",inputWidthSize:"6"},{label:"Marital status",fieldname:"marital",placeholder:"Select",value:"",id:15,keyboardType:"default",error:null,isRequired:!1,inputFieldType:"SELECT",isDropdownOpen:!1,selectBoxType:"marital",inputWidthSize:"6"},{label:"Anniversary date",fieldname:"anniversary",placeholder:"dd/mm/yyyy",value:"",id:16,keyboardType:"date",error:null,isRequired:!1,inputWidthSize:"6",isDisabled:!0},{label:"Referral code",fieldname:"referral",placeholder:"AXLTYD",value:"",id:6,keyboardType:"default",error:null,isRequired:!1},{label:"Favourite Home Location",fieldname:"homelocation",placeholder:"Select",value:"",id:19,keyboardType:"default",error:null,isRequired:!1,inputFieldType:"SELECT",inputAllowed:!0,isDropdownOpen:!1,selectBoxType:"homelocation",emptyErrorMessage:"Please provide your Favourite Home Location.",inputWidthSize:"12"},{label:"I agree to receive loyalty rewards, offers and updates via email and text.",value:!0,id:17,error:null,isRequired:!0,emptyErrorMessage:"Please agree to receive loyalty reward communications if you wish to signup to our loyalty program.",inputWidthSize:"12",inputFieldType:"CHECKBOX"}]),[j,S]=(0,r.useState)(null!==(l=null==t?void 0:t.storeId)&&void 0!==l?l:null),[k,T]=(0,r.useState)(null),[C,E]=(0,r.useState)(!1),[R,L]=(0,r.useState)({country:u.Ju,state:[],city:[],gender:f,marital:v,homelocation:[]}),[O,I]=(0,r.useState)(!1),{apiPost:A}=(0,p.kL)(),{nameValidation:D,emailValidation:F,phoneValidation:U,passwordValidation:z,returnErrorTexts:V}=(0,p.V$)(),M=e=>{let l=[...N];l[e].isDropdownOpen=!N[e].isDropdownOpen,P(l)},W=e=>{let l=[...N];"Married"===e.value?l[b.anniversary].isDisabled=!1:(l[b.anniversary].isDisabled=!0,l[b.anniversary].value=""),P(l)},Z=(e,l,a,i)=>{let r=[...N];r[l].isDropdownOpen=!1,r[l].value=e.label,r[l].error=null,"marital"===i?W(e):"homelocation"===i&&S(e.value),P(r)},_=e=>{let l=[],a=[...N];if(a[b.homelocation].value=e,q.forEach(a=>{a.label.toLowerCase().includes(e)&&l.push({...a})}),l.length){let e={...R};a[b.homelocation].isDropdownOpen=!N[b.homelocation].isDropdownOpen,e.homelocation=[...l],L({...e})}P(a)},J=(e,l)=>{if(l===b.homelocation)_(e);else{let a=[...N];a[l].value=e,a[l].error=null,P(a)}},G=(e,l)=>{let a=[...N];a[l].countryCode="+".concat(e.code),a[l].countryCodeValue=e.code,P(a)},B=e=>{let l=[...N],a=N[e].isPasswordVisible;l[e].keyboardType=a?"password":"default",l[e].isPasswordVisible=!a,P(l)},H=async()=>{let e=await D(N[b.name].value),l=await F(N[b.email].value),i=await U(N[b.phone].value);if(e&&l&&i&&a){var r,t,s;let e;E(!0);let l="".concat(u.kh.qubriuxAPI,"/store/").concat(a,"/customer/web/sendOtp"),i=JSON.stringify({name:N[b.name].value,email:N[b.email].value.toLowerCase(),phone_number:"".concat(N[b.phone].countryCodeValue).concat(N[b.phone].value),deviceId:null,referralCode:N[b.referral].value?null===(r=N[b.referral].value)||void 0===r?void 0:r.toUpperCase():null,birthday:N[b.dob].value?N[b.dob].value:null,gender:N[b.gender].value?N[b.gender].value:null,maritalStatus:N[b.marital].value?N[b.marital].value:null,anniversaryDate:N[b.anniversary].value?N[b.anniversary].value:null,acceptChannelCommunications:N[b.checkBox].value.at,referrerStoreId:j});try{e=await A(l,i)}catch(e){T("Something went wrong! Please try again after some time."),E(!1)}console.log(l,i),(null===(t=e)||void 0===t?void 0:t.message.toLowerCase())==="success"?(console.log("response: ",e),n(i,e.body)):(null===(s=e)||void 0===s?void 0:s.message.toLowerCase())==="failure"&&e.body?(y[e.body]&&I(!0),T(e.body)):T("Something went wrong! Please try again after some time."),E(!1)}else{let r=[...N];e||(r[b.name].error=await V(N[b.name].value,"name")),l||(r[b.email].error=await V(N[b.email].value,"email")),i||(r[b.phone].error=await V(N[b.phone].value,"phone")),a||T("This link seems to be expired or broken, Please try again with another link."),P(r)}},X=()=>{let e=!0;return N.forEach(l=>{l.isRequired&&!l.value&&(e=!1)}),!e},K=(0,r.useMemo)(()=>X(),[N]),Q=()=>{let e=[...N];e[b.referral].value=s,P([...e])},Y=()=>{let e=[...N];N.forEach((l,a)=>{g[l.fieldname]||(e[a].isInputHidden=!0)}),P([...e])};return(0,r.useEffect)(()=>{if(t){let e=[...N];t.storeName&&(e[b.homelocation].value=t.storeName),P(e)}},[t]),(0,r.useEffect)(()=>{x&&Y()},[x]),(0,r.useEffect)(()=>{s&&Q()},[s]),(0,i.jsxs)("form",{className:"qb-signup-form px-md-5 py-5 d-flex flex-column align-items-stretch",id:"qb-signupform",onSubmit:e=>{e.preventDefault()},children:[(0,i.jsx)("h3",{className:"qb-title mb-0 pb-4 qb-signup-title-text",children:"Create account"}),(0,i.jsx)("div",{className:"container-fluid px-0 pt-md-0",children:(0,i.jsxs)("div",{className:"row gy-3",children:[N.map((e,l)=>e.isInputHidden?null:(0,i.jsx)("div",{className:"col-12 col-lg-".concat(e.inputWidthSize),children:e.inputFieldType&&"SELECT"===e.inputFieldType?(0,i.jsx)(d.jL,{value:e.value,id:e.id,index:l,label:e.label,placeholder:e.placeholder,fieldname:e.fieldname,error:e.error,isRequired:e.isRequired,fieldType:e.keyboardType,options:R[e.selectBoxType],isDropdownOpen:e.isDropdownOpen,inputAllowed:e.inputAllowed,onClick:M,onChange:J,onSelect:Z}):e.inputFieldType&&"PHONE"===e.inputFieldType?(0,i.jsx)(d.sb,{value:e.value,id:e.id,index:l,label:e.label,placeholder:e.placeholder,fieldname:e.fieldname,error:e.error,isRequired:e.isRequired,countryCode:e.countryCode,codePlaceholder:e.countryCodePlaceholder,isDisabled:e.isDisabled,onCountryCodeSelect:G,onChange:J}):e.inputFieldType&&"MULTI_LINE"===e.inputFieldType?(0,i.jsx)(d.zC,{value:e.value,id:e.id,index:l,label:e.label,placeholder:e.placeholder,fieldname:e.fieldname,error:e.error,isRequired:e.isRequired,isDisabled:e.isDisabled,onChange:J}):e.inputFieldType&&"CHECKBOX"===e.inputFieldType?(0,i.jsx)(d.Jg,{value:e.value,id:e.id,index:l,label:e.label,error:e.error,isDisabled:e.isDisabled,onChange:J}):(0,i.jsx)(d.Wz,{value:e.value,id:e.id,index:l,label:e.label,placeholder:e.placeholder,fieldname:e.fieldname,error:e.error,isRequired:e.isRequired,fieldType:e.keyboardType,isPassword:e.isPassword,showPassword:e.isPasswordVisible,isDisabled:e.isDisabled,onViewPassword:B,onChange:J})},"input-".concat(l))),(null==k?void 0:k.length)?(0,i.jsx)("div",{className:"col-12",children:(0,i.jsx)("p",{className:"qb-input-error-message mt-1 qb-general-error qb-error-active",children:k})}):null,(0,i.jsx)("div",{className:"col-lg-12",children:(0,i.jsxs)("div",{className:"w-100 pt-md-3 pt-3 d-flex flex-column flex-md-row-reverse align-items-stretch align-items-md-center justify-content-start",children:[(0,i.jsx)(c.K,{id:"qb-profile-btn",isDisabled:K,isLoading:C,onDisabledClick:()=>{let e=[...N];N.forEach((l,a)=>{l.isRequired&&!l.value&&(e[a].error=l.emptyErrorMessage?l.emptyErrorMessage:"Required field. Please fill this field to continue.")}),P([...e])},onClick:H,children:(0,i.jsxs)(i.Fragment,{children:["Signup",(0,i.jsx)("span",{className:"qb-btn-loader ms-2"})]})}),x?(0,i.jsx)("div",{className:"d-flex pe-md-4 align-items-center pt-4 pt-md-0 justify-content-center",children:(0,i.jsx)("a",{className:"qb-link",href:"https://shop.qffer.in/download",children:"Download Qffer"})}):null]})}),(0,i.jsx)("div",{className:"col-12",children:(0,i.jsx)("div",{className:"w-100 flex-column align-items-center align-items-md-end d-flex",children:!x&&O&&m?(0,i.jsxs)("p",{className:"qb-description",children:["Already signed up? ",(0,i.jsx)("a",{onClick:w,className:"qb-link",children:"Visit shop page"})]}):!x&&o?(0,i.jsxs)("p",{className:"qb-description",children:["Already have an account? ",(0,i.jsx)(h(),{href:o,className:"qb-link",children:"Login"})]}):null})})]})})]})},x=a(5353),q=a(2688),N=a(6775),P=a(6835),j=()=>{let[e,l]=(0,r.useState)("SIGNUP"),[a,t]=(0,r.useState)(null),[d,c]=(0,r.useState)(!1),[m,h]=(0,r.useState)(null),[b,f]=(0,r.useState)(""),[v,y]=(0,r.useState)(null),[g,j]=(0,r.useState)(!1),[S,k]=(0,r.useState)(null),[T,C]=(0,r.useState)(null),[E,R]=(0,r.useState)(!1),[L,O]=(0,r.useState)(!1),[I,A]=(0,r.useState)(null),{breakDownUrl:D}=(0,p.ZN)(),{apiGet:F}=(0,p.kL)(),[U,z]=(0,r.useState)(null),V=(0,n.useRouter)(),M=async e=>{let l=RegExp("^([a-zA-Z]+:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");return l.test(e)},W=()=>{l("SIGNUP")},Z=async e=>{let l=null!=e&&!!e.redirectURL&&await M(e.redirectURL);l&&!e.redirectURL.includes("login")?window.location.href=e.redirectURL:(l&&(null==e?void 0:e.redirectURL)&&k(e.redirectURL),W(),j(!0))},_=e=>{let l="/auth/login";if(e.queries){let a;let i=0;for(a in e.queries)l="".concat(l).concat(0===i?"?":"&").concat(a,"=").concat(e.queries[a]),i++}f(l)},J=async e=>{let l,a="".concat(u.kh.qubriuxAPI,"/store/").concat(e,"/customer/web/signUp/email/store-info");try{return l=await F(a)}catch(e){return console.log(e),l}},G=(e,l)=>{C({title:e,message:l}),R(!0)},B=async e=>{var l,a,i;let r=await J(e);if(console.log("resp: ",r),r&&(null===(l=r.message)||void 0===l?void 0:l.toLowerCase())==="success"&&r.body){console.log("resp: ",r);let e=!1;(null===(i=r.body.platform)||void 0===i?void 0:i.toLowerCase())==="qffer"&&(e=!0),c(e),O(!0),A(r.body),console.log(r.body);let l=!!r.body.redirectURL&&await M(r.body.redirectURL);l&&r.body.redirectType&&"SHOP_URL"===r.body.redirectType&&k(r.body.redirectURL)}else(null==r?void 0:r.message)&&(null===(a=r.message)||void 0===a?void 0:a.toLowerCase())==="failure"&&r.body&&"Something went wrong"!=r.body?(console.log("error"),setTimeout(()=>{G("Invalid link",r.body)},300)):(console.log("error"),setTimeout(()=>{G("Invalid link","Oops! this link seems to be expired or broken, Please try again with another link.")},300))},H=async e=>{let l,a="".concat(u.kh.qubriuxAPI,"/store/").concat(e,"/customer/web/signUp/listStores");try{l=await F(a);let e=l.body,i=e.map(e=>({label:e.storeName,value:e.storeId}));z(i)}catch(e){return console.log(e),l}},X=async()=>{let e=window.location.href,l=await D(e);_(l),l.queries&&l.queries.amx&&(B(l.queries.amx),H(l.queries.amx),t(l.queries.amx)),l.queries&&l.queries.ref&&h(l.queries.ref)};return(0,r.useEffect)(()=>{X()},[]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s(),{children:(0,i.jsx)("title",{children:"Qffer | Signup"})}),L?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.Z,{type:d?"QFFER":"GENERIC",logo:null==I?void 0:I.logo,brandColor:null==I?void 0:I.brandColor,children:"SIGNUP"===e?(0,i.jsx)(w,{storeId:a,storeData:I,referral:m,navigateToOtp:(e,a)=>{var i,r,t;let s=JSON.parse(e);console.log(s),s.storeId=null!==(r=null==a?void 0:a.storeId)&&void 0!==r?r:null,s.merchantCustomerId=null!==(t=null==a?void 0:null===(i=a.posCustomer)||void 0===i?void 0:i.merchantCustomerId)&&void 0!==t?t:null,y(s),l("OTP")},loginUrl:b,redirectLink:S,handleRedirect:()=>{S&&(window.location.href=S)},isQffer:d,storeListing:U}):(0,i.jsx)(x.Z,{authType:"SIGNUP",user:v,handleSuccess:Z,storeId:a})}),(0,i.jsx)(q.Z,{isVisible:g,handleBackdropClick:()=>{j(!1),d||(S?window.location.href=S:V.push(b))},title:"Welcome Aboard",message:"Congratulations on signing up for our loyalty program. Stay Tuned! Exciting offers and loyalty rewards are on your way. ".concat(d?" Download Qffer and make use of full extend of Qffer services today.":""),isQffer:d})]}):(0,i.jsx)(P.Z,{removePreloader:L,loaderType:"GENERIC"}),(0,i.jsx)(N.Z,{isVisible:E,handleBackdropClick:()=>{},title:null==T?void 0:T.title,message:null==T?void 0:T.message})]})}}},function(e){e.O(0,[1664,3582,6211,9774,2888,179],function(){return e(e.s=6700)}),_N_E=e.O()}]);