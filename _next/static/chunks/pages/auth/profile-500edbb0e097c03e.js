(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6869],{2365:function(e,l,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/auth/profile",function(){return a(934)}])},5494:function(e,l){"use strict";l.Z={src:"/_next/static/media/general.7095fc5d.png",height:506,width:500,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAxUlEQVR42mPABX6UNDP+a21nhAt8K29n/5zTovGtqFX3Z207N1zieWgHE4j+mNtm/qG0x/N7cbPW9/JWh9/1bVJ/G9uEwYreJ7WJfMjvjXhX3Jn+PrvJ5H99P/+fhnaNP41tSgwvPKpE38R3ur0vnxT3oayt/ENVQ8WnjnLjX+2NKv+bujgZXgY0sL6JbBL8kNth+LmizfZLXaPdl+Zam58tDZIYLn9TO5X9TXs9O4z/pbUK4ou38W2MH9PyGVG82dIA5gMAcORU4v0N6lsAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8}},6775:function(e,l,a){"use strict";var r=a(5893);a(7294);var i=a(511),t=a(5675),o=a.n(t),n=a(5494);l.Z=e=>{let{isVisible:l,handleBackdropClick:a,title:t,message:s}=e;return(0,r.jsx)(i.Z,{isVisible:l,handleBackdropClick:a,children:(0,r.jsxs)("div",{className:"w-100 p-5",children:[(0,r.jsx)("div",{className:"qb-popup-illustration-wrapper pb-3 w-100 d-flex align-items-center justify-content-center",children:(0,r.jsx)(o(),{src:n.Z,alt:"success",className:"qb-popup-illustration"})}),(0,r.jsx)("h3",{className:"qb-title mb-0 pb-3 pt-5",children:t}),(0,r.jsx)("p",{className:"qb-description mb-0 pb-4",children:s})]})})}},934:function(e,l,a){"use strict";a.r(l),a.d(l,{default:function(){return T}});var r=a(5893),i=a(7294),t=a(9008),o=a.n(t),n=a(1163),s=a(5353),d=a(8295),u=a(3582),c=a(6264),p=a(5202),m=a(4047),y=a(9655);let v={name:0,email:1,phone:2,country:3,state:4,city:5,referral:6,dob:7,gender:8,marital:9,anniversary:10,checkBox:12,homelocation:11},h=[{label:"Male",value:"Male"},{label:"Female",value:"Female"},{label:"Prefer not to answer/other",value:"Prefer not to answer/other"}],b=[{label:"Single",value:"Single"},{label:"Married",value:"Married"},{label:"Prefer not to answer/other",value:"Prefer not to answer/other"}];var g=e=>{var l;let{navigateToOtp:a,customerDetails:t,token:o,successPopup:n,storeListing:s}=e,[d,g]=(0,i.useState)([{label:"Name",fieldname:"name",placeholder:"John Doe",value:"",id:1,keyboardType:"default",error:null,isRequired:!0,emptyErrorMessage:"Name is required. Please provide your name.",inputWidthSize:"12"},{label:"Email",fieldname:"email",placeholder:"johndoe@company.com",value:"",id:2,keyboardType:"email",error:null,isRequired:!0,emptyErrorMessage:"Email is required. Please provide your email address.",inputWidthSize:"6"},{label:"Phone",fieldname:"phone",placeholder:"999 999 9999",value:"",countryCodeValue:"91",id:3,keyboardType:"phone",error:null,isRequired:!0,inputFieldType:"DEFAULT",emptyErrorMessage:"Phone number is required. Please provide your Phone number.",inputWidthSize:"6"},{label:"Country",fieldname:"country",placeholder:"India",value:"",id:10,keyboardType:"default",error:null,isRequired:!1,inputFieldType:"SELECT",isDropdownOpen:!1,selectBoxType:"country",emptyErrorMessage:"Country name is required. Please select your Country.",inputWidthSize:"12"},{label:"State",fieldname:"state",placeholder:"Karnataka",value:"",id:11,keyboardType:"default",error:null,isRequired:!1,inputFieldType:"SELECT_TYPE",isDropdownOpen:!1,selectBoxType:"state",emptyErrorMessage:"State is required. Please select your State.",inputWidthSize:"6"},{label:"City",fieldname:"city",placeholder:"Bengaluru",value:"",id:12,keyboardType:"default",error:null,isRequired:!1,inputFieldType:"SELECT_TYPE",isDropdownOpen:!1,selectBoxType:"city",emptyErrorMessage:"City name is required. Please select your City.",inputWidthSize:"6"},{label:"Referral code",fieldname:"referral",placeholder:"AXLTYD",value:"",id:6,keyboardType:"default",error:null,isRequired:!1},{label:"Date of birth",fieldname:"dob",placeholder:"dd/mm/yyyy",value:"",id:13,keyboardType:"date",error:null,isRequired:!1,emptyErrorMessage:"Date of birth is required. Please provide your birth date.",inputWidthSize:"6"},{label:"Gender",fieldname:"gender",placeholder:"Select",value:"",id:14,keyboardType:"default",error:null,isRequired:!1,inputFieldType:"SELECT",isDropdownOpen:!1,selectBoxType:"gender",emptyErrorMessage:"Gender is required. Please provide your gender.",inputWidthSize:"6"},{label:"Marital status",fieldname:"marital",placeholder:"Select",value:"",id:15,keyboardType:"default",error:null,isRequired:!1,inputFieldType:"SELECT",isDropdownOpen:!1,selectBoxType:"marital",inputWidthSize:"6"},{label:"Anniversary date",fieldname:"anniversary",placeholder:"dd/mm/yyyy",value:"",id:16,keyboardType:"date",error:null,isRequired:!1,isInputHidden:!0,inputWidthSize:"6"},{label:"Favourite Home Location",fieldname:"homelocation",placeholder:"Select",value:"",id:19,keyboardType:"default",error:null,isRequired:!1,inputFieldType:"SELECT",isDropdownOpen:!1,selectBoxType:"homelocation",emptyErrorMessage:"Please provide your Favourite Home Location.",inputWidthSize:"12"},{label:"I agree to receive loyalty rewards, offers and updates via email and text.",value:!0,id:17,error:null,isRequired:!0,emptyErrorMessage:"Please agree to receive loyalty reward communications if you wish to signup to our loyalty program.",inputWidthSize:"12",inputFieldType:"CHECKBOX"}]),[f,w]=(0,i.useState)({country:p.Ju,state:[],city:[],gender:h,marital:b,homelocation:s}),[x,T]=(0,i.useState)(null!==(l=null==t?void 0:t.storeId)&&void 0!==l?l:null),[S,E]=(0,i.useState)(null),[C,q]=(0,i.useState)(null),[P,k]=(0,i.useState)(null),[N,j]=(0,i.useState)([]),[L,A]=(0,i.useState)([]),[R,D]=(0,i.useState)(null),[O,F]=(0,i.useState)(!1),{nameValidation:I,emailValidation:M,passwordValidation:W,returnErrorTexts:B}=(0,y.V$)(),{apiPut:z}=(0,y.kL)(),_=e=>{let l=[...d];l[e].isDropdownOpen=!d[e].isDropdownOpen,g(l)},V=e=>{let l=m.FH[e.value];console.log("options: ",l),j([...l]),E(e)},Z=e=>{A([...m._I[e.value]]),q(e)},H=e=>{k(e)},X=e=>{let l=[...d];"Married"===e.value?l[v.anniversary].isInputHidden=!1:l[v.anniversary].isInputHidden=!0,g(l)},J=(e,l,a,r)=>{let i=[...d];i[l].isDropdownOpen=!1,i[l].value=e.label,i[l].error=null,"country"===r?V(e):"state"===r?Z(e):"city"===r?H(e):"marital"===r?X(e):"homelocation"===r&&T(e.value),g(i)},U=(e,l,a,r)=>{let i={...f};i[r]=l,w(i);let t=[...d];t[e].isDropdownOpen=a,console.log("options: ",i,a,e,t[e]),g(t)},G=(e,l)=>{let a=[];(null==e?void 0:e.length)&&e.length>1?(console.log("Val: ",e),N.forEach(l=>{l.label.toLowerCase().includes(e.toLowerCase())&&a.push(l)}),(null==a?void 0:a.length)&&U(l,a,!0,"state")):e&&e.length||U(l,a,!1,"state")},K=(e,l)=>{let a=[];(null==e?void 0:e.length)&&e.length>1?(console.log("Val: ",e),L.forEach(l=>{l.label.toLowerCase().includes(e.toLowerCase())&&a.push(l)}),(null==a?void 0:a.length)&&U(l,a,!0,"city")):e&&e.length||U(l,a,!1,"city")},Y=(e,l,a)=>{"state"===a?G(e,l):"city"===a&&K(e,l)},Q=(e,l,a,r)=>{let i=[...d];i[l].value=e,i[l].error=null,r&&Y(e,l,r),g(i)},$=e=>{let l=[...d],a=d[e].isPasswordVisible;l[e].keyboardType=a?"password":"default",l[e].isPasswordVisible=!a,g(l)},ee=async()=>{let e=await I(d[v.name].value),l=await M(d[v.email].value);if(e&&l){var a,r,i;let e;F(!0);let l="".concat(p.kh.qubriuxAPI,"/store/123/customer/web/profile"),s=JSON.stringify({name:d[v.name].value,email:t.email?t.email:d[v.email].value.toLowerCase(),phone_number:t.phone?t.phone:"".concat(d[v.phone].countryCodeValue).concat(d[v.phone].value),deviceId:null,referralCode:d[v.referral].value?null===(a=d[v.referral].value)||void 0===a?void 0:a.toUpperCase():null,birthday:d[v.dob].value?d[v.dob].value:null,gender:d[v.gender].value?d[v.gender].value:null,state:d[v.state].value?d[v.state].value:null,city:d[v.city].value?d[v.city].value:null,country:d[v.country].value?d[v.country].value:null,maritalStatus:d[v.marital].value?d[v.marital].value:null,anniversaryDate:d[v.anniversary].value?d[v.anniversary].value:null,acceptChannelCommunications:d[v.checkBox].value,referrerStoreId:x});try{e=await z(l,s,null,o)}catch(e){D("Something went wrong! Please try again after some time."),F(!1)}(null===(r=e)||void 0===r?void 0:r.message.toLowerCase())==="success"?(console.log("response: ",e),n()):(null===(i=e)||void 0===i?void 0:i.message.toLowerCase())==="failure"&&e.body?D(e.body):D("Something went wrong! Please try again after some time."),F(!1)}else{let a=[...d];e||(a[v.name].error=await B(d[v.name].value,"name")),l||(a[v.email].error=await B(d[v.email].value,"email")),g(a)}},el=()=>{let e=!0;return d.forEach(l=>{l.isRequired&&!l.value&&(e=!1)}),!e};(0,i.useEffect)(()=>{if(console.log(s),t&&s){let e=[...d];t.customerName&&(e[v.name].value=t.customerName),t.emailAddress&&(e[v.email].value=t.emailAddress,e[v.email].isDisabled=!0),t.mobileNumber&&(e[v.phone].value=t.mobileNumber,e[v.phone].isDisabled=!0),t.gender&&(e[v.gender].value=t.gender),t.birthday&&(e[v.dob].value=t.birthday),t.countryCode&&(e[v.country].value=t.countryCode),t.state&&(e[v.state].value=t.state),t.city&&(e[v.city].value=t.city),t.referralCode&&(e[v.referral].value=t.referralCode),t.maritalStatus&&(e[v.marital].value=t.maritalStatus,"Married"===t.maritalStatus&&(e[v.anniversary].isInputHidden=!1)),t.anniversary&&(e[v.anniversary].value=t.anniversary),t.storeName&&(e[v.homelocation].value=t.storeName),g(e)}},[t,s]);let ea=(0,i.useMemo)(()=>el(),[d]);return(0,r.jsxs)("form",{className:"qb-signup-form px-md-5 py-5 d-flex flex-column align-items-stretch",id:"qb-signupform",children:[(0,r.jsx)("h3",{className:"qb-title mb-0 pb-4 qb-signup-title-text",children:"Complete Profile"}),(0,r.jsx)("div",{className:"container-fluid px-0 pt-md-0",children:(0,r.jsxs)("div",{className:"row gy-3",children:[d.map((e,l)=>e.isInputHidden?null:(0,r.jsx)("div",{className:"col-12 col-lg-".concat(e.inputWidthSize),children:e.inputFieldType&&"SELECT_TYPE"===e.inputFieldType?(0,r.jsx)(u.jL,{value:e.value,id:e.id,index:l,label:e.label,placeholder:e.placeholder,fieldname:e.fieldname,error:e.error,isRequired:e.isRequired,fieldType:e.keyboardType,inputAllowed:!0,options:f[e.selectBoxType],isDropdownOpen:e.isDropdownOpen,onClick:_,onChange:Q,onSelect:J}):e.inputFieldType&&"SELECT"===e.inputFieldType?(0,r.jsx)(u.jL,{value:e.value,id:e.id,index:l,label:e.label,placeholder:e.placeholder,fieldname:e.fieldname,error:e.error,isRequired:e.isRequired,fieldType:e.keyboardType,options:f[e.selectBoxType],isDropdownOpen:e.isDropdownOpen,onClick:_,onChange:Q,onSelect:J}):e.inputFieldType&&"MULTI_LINE"===e.inputFieldType?(0,r.jsx)(u.zC,{value:e.value,id:e.id,index:l,label:e.label,placeholder:e.placeholder,fieldname:e.fieldname,error:e.error,isRequired:e.isRequired,isDisabled:e.isDisabled,onChange:Q}):e.inputFieldType&&"CHECKBOX"===e.inputFieldType?(0,r.jsx)(u.Jg,{value:e.value,id:e.id,index:l,label:e.label,error:e.error,isDisabled:e.isDisabled,onChange:Q}):(0,r.jsx)(u.Wz,{value:e.value,id:e.id,index:l,label:e.label,placeholder:e.placeholder,fieldname:e.fieldname,error:e.error,isRequired:e.isRequired,fieldType:e.keyboardType,isPassword:e.isPassword,showPassword:e.isPasswordVisible,isDisabled:e.isDisabled,onViewPassword:$,onChange:Q})},"input-".concat(l))),(null==R?void 0:R.length)?(0,r.jsx)("div",{className:"col-12",children:(0,r.jsx)("p",{className:"qb-input-error-message mt-1 qb-general-error qb-error-active",children:R})}):null,(0,r.jsx)("div",{className:"col-lg-12",children:(0,r.jsx)("div",{className:"w-100 pt-md-3 pt-3 d-flex flex-column flex-md-row align-items-stretch align-items-md-center justify-content-end",children:(0,r.jsx)(c.K,{id:"qb-profile-btn",isDisabled:ea,isLoading:O,onDisabledClick:()=>{let e=[...d];d.forEach((l,a)=>{l.isRequired&&!l.value&&(e[a].error=l.emptyErrorMessage?l.emptyErrorMessage:"Required field. Please fill this field to continue.")}),g([...e])},onClick:ee,children:(0,r.jsxs)(r.Fragment,{children:["Signup",(0,r.jsx)("span",{className:"qb-btn-loader ms-2"})]})})})})]})})]})},f=a(2688),w=a(6835),x=a(6775),T=()=>{let[e,l]=(0,i.useState)("PROFILE"),[a,t]=(0,i.useState)(!1),[u,c]=(0,i.useState)(!1),[m,v]=(0,i.useState)(null),[h,b]=(0,i.useState)(null),[T,S]=(0,i.useState)(!1),[E,C]=(0,i.useState)(null),[q,P]=(0,i.useState)(null),[k,N]=(0,i.useState)(!1),[j,L]=(0,i.useState)(""),{apiPost:A,apiGet:R}=(0,y.kL)(),{breakDownUrl:D}=(0,y.ZN)(),[O,F]=(0,i.useState)(null);(0,n.useRouter)();let I=()=>{l("PROFILE")},M=()=>{I(),S(!0)},W=(e,l)=>{P({title:e,message:l}),N(!0)},B=async(e,l)=>{let a="".concat(p.kh.qfferAPI,"/customer/auth/verify/cx/email/").concat(e),r=JSON.stringify({value:l});try{await A(a,r)}catch(e){console.log("verify",e)}},z=async e=>{let l,a="".concat(p.kh.qubriuxAPI,"/store/123/customer/web/profile");try{return l=await R(a,null,e)}catch(e){return console.log(e),l}},_=async e=>{let l,a="".concat(p.kh.qubriuxAPI,"/store/").concat(e,"/customer/web/signUp/listStores");try{let e=(l=await R(a)).body;console.log(l.body);let r=e.map(e=>({label:e.storeName,value:e.storeId}));F(r),t(!0)}catch(e){return console.log(e),l}},V=async e=>{var l,a,r,i;let t=await z(e);if(console.log("resp: ",t),t&&"success"===t.message.toLowerCase()){let e="/auth/login",o=!1;(null===(a=t.body)||void 0===a?void 0:null===(l=a.platform)||void 0===l?void 0:l.toLowerCase())==="qffer"&&(o=!0),(null==t?void 0:null===(r=t.body)||void 0===r?void 0:r.amx)&&(e="".concat(e,"?amx=").concat(t.body.amx)),c(o),L(e),b(t.body),_(null===(i=t.body)||void 0===i?void 0:i.amx),console.log("login: ",e)}else(null==t?void 0:t.message)&&"failure"===t.message.toLowerCase()&&t.body&&"Something went wrong"!=t.body?(console.log("error"),setTimeout(()=>{W("Invalid link",t.body)},300)):(console.log("error"),setTimeout(()=>{W("Invalid link","Oops! this link seems to be expired or broken, Please try again with another link.")},300))},Z=async()=>{var e,l,a;let r=window.location.href,i=await D(r);if((null===(e=i.queries)||void 0===e?void 0:e.tx)?(C(i.queries.tx),V(i.queries.tx)):setTimeout(()=>{W("Invalid link","Oops! this link seems to be expired or broken, Please try again with another link.")},1e3),(null===(l=i.queries)||void 0===l?void 0:l.cx)&&(null===(a=i.queries)||void 0===a?void 0:a.k)){let e=await B(i.queries.k,i.queries.cx);e&&console.log("success: ",e)}};return(0,i.useEffect)(()=>{Z()},[]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o(),{children:(0,r.jsx)("title",{children:"Qffer | Profile"})}),a?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Z,{type:u?"QFFER":"GENERIC",logo:null==h?void 0:h.storeLogoUrl,brandColor:null==h?void 0:h.storeBrandColor,children:"PROFILE"===e?(0,r.jsx)(g,{navigateToOtp:e=>{v(JSON.parse(e)),l("OTP")},customerDetails:h,token:E,successPopup:M,storeListing:O}):(0,r.jsx)(s.Z,{authType:"PROFILE",user:m,handleSuccess:M,token:E})}),(0,r.jsx)(f.Z,{isVisible:T,handleBackdropClick:()=>{S(!1),j&&(window.location.href=j)},title:"Welcome Aboard",message:"Congratulations on signing up for our loyalty program. Stay Tuned! Exciting offers and loyalty rewards are on your way.",isQffer:u})]}):(0,r.jsx)(w.Z,{removePreloader:a,loaderType:"GENERIC"}),(0,r.jsx)(x.Z,{isVisible:k,handleBackdropClick:()=>{},title:null==q?void 0:q.title,message:null==q?void 0:q.message})]})}}},function(e){e.O(0,[3582,6211,4345,9774,2888,179],function(){return e(e.s=2365)}),_N_E=e.O()}]);