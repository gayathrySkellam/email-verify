(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4076],{9021:function(e,s,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/auth/forgot-password",function(){return a(7246)}])},5494:function(e,s){"use strict";s.Z={src:"/_next/static/media/general.7095fc5d.png",height:506,width:500,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAxUlEQVR42mPABX6UNDP+a21nhAt8K29n/5zTovGtqFX3Z207N1zieWgHE4j+mNtm/qG0x/N7cbPW9/JWh9/1bVJ/G9uEwYreJ7WJfMjvjXhX3Jn+PrvJ5H99P/+fhnaNP41tSgwvPKpE38R3ur0vnxT3oayt/ENVQ8WnjnLjX+2NKv+bujgZXgY0sL6JbBL8kNth+LmizfZLXaPdl+Zam58tDZIYLn9TO5X9TXs9O4z/pbUK4ou38W2MH9PyGVG82dIA5gMAcORU4v0N6lsAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8}},511:function(e,s,a){"use strict";var l=a(5893),r=a(7294);s.Z=e=>{let{children:s,isVisible:a,handleBackdropClick:o,isLarge:i}=e,[t,n]=(0,r.useState)(!1),[d,c]=(0,r.useState)(!1),u=()=>{n(!0),setTimeout(()=>{c(!0)},400)},p=()=>{c(!1),setTimeout(()=>{n(!1)},400)};return(0,r.useEffect)(()=>{a?u():t&&p()},[a]),(0,l.jsx)("div",{className:t?"qb-modal-wrapper position-fixed":"qb-modal-wrapper position-fixed d-none",onClick:o,children:(0,l.jsx)("div",{className:d?"qb-modal-wrap  qb-modal-active":"qb-modal-wrap",children:(0,l.jsx)("div",{className:i?"qb-modal-large qb-modal-dialog-wrapper position-relative":"qb-modal-dialog-wrapper position-relative",children:(0,l.jsx)("div",{className:"qb-modal-dialog position-absolute d-flex align-items-stretch justify-content-center position-absolute",onClick:e=>{e.stopPropagation()},children:s})})})})}},6775:function(e,s,a){"use strict";var l=a(5893);a(7294);var r=a(511),o=a(5675),i=a.n(o),t=a(5494);s.Z=e=>{let{isVisible:s,handleBackdropClick:a,title:o,message:n}=e;return(0,l.jsx)(r.Z,{isVisible:s,handleBackdropClick:a,children:(0,l.jsxs)("div",{className:"w-100 p-5",children:[(0,l.jsx)("div",{className:"qb-popup-illustration-wrapper pb-3 w-100 d-flex align-items-center justify-content-center",children:(0,l.jsx)(i(),{src:t.Z,alt:"success",className:"qb-popup-illustration"})}),(0,l.jsx)("h3",{className:"qb-title mb-0 pb-3 pt-5",children:o}),(0,l.jsx)("p",{className:"qb-description mb-0 pb-4",children:n})]})})}},7877:function(e,s,a){"use strict";var l=a(5893),r=a(7294),o=a(3582),i=a(6264),t=a(5202),n=a(9655);let d={password:0,confirmPassword:1};s.Z=e=>{let{storeId:s,user:a,handleSuccess:c,token:u}=e,[p,m]=(0,r.useState)([{label:"New Password",fieldname:"password",placeholder:"********",value:"",id:4,keyboardType:"password",error:null,isRequired:!0,isPassword:!0,isPasswordVisible:!1,emptyErrorMessage:"Please provide a suitable new password.",inputWidthSize:"12"},{label:"Confirm password",fieldname:"confirm_password",placeholder:"********",value:"",id:8,keyboardType:"password",error:null,isRequired:!0,isPassword:!0,isPasswordVisible:!1,emptyErrorMessage:"Please repeat the new password you entered.",inputWidthSize:"12"}]),[w,h]=(0,r.useState)(null),[b,g]=(0,r.useState)(!1),{apiPost:f}=(0,n.kL)(),{passwordValidation:v,returnErrorTexts:x}=(0,n.V$)(),P=(e,s)=>{let a=[...p];a[s].value=e,a[s].error=null,m(a)},y=e=>{let s=[...p],a=p[e].isPasswordVisible;s[e].keyboardType=a?"password":"default",s[e].isPasswordVisible=!a,m(s)},q=async()=>{g(!0),h(null);let e=p[d.password].value===p[d.confirmPassword].value,l=await v(p[d.password].value);if(e&&l){var r,o,i,n;let e;let l="".concat(t.kh.qubriuxAPI,"/store/").concat(s,"/customer/resetPassword"),m=JSON.stringify({email:a.email,phone:a.phoneNo,storeId:s,newPassword:p[d.password].value});try{e=await f(l,m,u)}catch(e){console.log("err: ",e),h("Something went wrong! Please try again after some time."),g(!1)}(null===(o=e)||void 0===o?void 0:null===(r=o.message)||void 0===r?void 0:r.toLowerCase())==="success"?(console.log("response: ",e),c(e.body)):(null===(n=e)||void 0===n?void 0:null===(i=n.message)||void 0===i?void 0:i.toLowerCase())==="failure"&&e.body?h(e.body):h("Something went wrong! Please try again after some time."),g(!1)}else{let s=[...p];e||h("Passwords donot match! Please ensure you have re-entered the same password."),l||(s[d.password].error=await x(p[d.password].value,"password")),m(s),g(!1)}},j=()=>{let e=!0;return p.forEach(s=>{s.isRequired&&!s.value&&(e=!1)}),!e},N=(0,r.useMemo)(()=>j(),[p]);return(0,l.jsxs)("form",{className:"qb-signup-form px-md-5 py-5 d-flex flex-column align-items-stretch",id:"qb-signupform",children:[(0,l.jsx)("h3",{className:"qb-title mb-0 pb-4 qb-signup-title-text",children:"Set new password"}),(0,l.jsx)("div",{className:"container-fluid px-0 pt-md-0",children:(0,l.jsxs)("div",{className:"row gy-3",children:[p.map((e,s)=>e.isInputHidden?null:(0,l.jsx)("div",{className:"col-12 col-lg-".concat(e.inputWidthSize),children:(0,l.jsx)(o.Wz,{value:e.value,id:e.id,index:s,label:e.label,placeholder:e.placeholder,fieldname:e.fieldname,error:e.error,isRequired:e.isRequired,fieldType:e.keyboardType,isPassword:e.isPassword,showPassword:e.isPasswordVisible,isDisabled:e.isDisabled,onViewPassword:y,onChange:P})},"input-".concat(s))),(null==w?void 0:w.length)?(0,l.jsx)("div",{className:"col-12",children:(0,l.jsx)("p",{className:"qb-input-error-message mt-1 qb-general-error qb-error-active",children:w})}):null,(0,l.jsx)("div",{className:"col-lg-12",children:(0,l.jsx)("div",{className:"w-100 pt-md-3 pt-3 d-flex flex-column flex-md-row align-items-stretch align-items-md-center justify-content-end",children:(0,l.jsx)(i.K,{id:"qb-profile-btn",isDisabled:N,isLoading:b,onDisabledClick:()=>{let e=[...p];p.forEach((s,a)=>{s.isRequired&&!s.value&&(e[a].error=s.emptyErrorMessage?s.emptyErrorMessage:"Required field. Please fill this field to continue.")}),m([...e])},onClick:q,children:(0,l.jsxs)(l.Fragment,{children:["Reset Password",(0,l.jsx)("span",{className:"qb-btn-loader ms-2"})]})})})})]})})]})}},7246:function(e,s,a){"use strict";a.r(s);var l=a(5893),r=a(7294),o=a(1163),i=a(9008),t=a.n(i),n=a(8295),d=a(2838),c=a(3553),u=a(9655),p=a(5202),m=a(6775),w=a(6835),h=a(5785),b=a(5353),g=a(7877);s.default=()=>{let[e,s]=(0,r.useState)(null),[a,i]=(0,r.useState)(""),[f,v]=(0,r.useState)(""),[x,P]=(0,r.useState)(!1),[y,q]=(0,r.useState)(!1),[j,N]=(0,r.useState)(!1),[S,A]=(0,r.useState)(null),[k,E]=(0,r.useState)(null),[T,Z]=(0,r.useState)(null),[C,R]=(0,r.useState)(!1),[I,L]=(0,r.useState)(!1),[V,_]=(0,r.useState)(null),{breakDownUrl:O}=(0,u.ZN)(),{onSignUp:U}=(0,d.ZP)(),{updateUserStorageData:W}=(0,c.Z)(),{apiGet:X}=(0,u.kL)();(0,o.useRouter)();let D=e=>{let s="/auth/signup",a="/auth/login";if(e.queries){let l;let r=0;for(l in e.queries)s="".concat(s).concat(0===r?"?":"&").concat(l,"=").concat(e.queries[l]),a="".concat(a).concat(0===r?"?":"&").concat(l,"=").concat(e.queries[l]),r++}i(s),v(a)},G=async e=>{let s,a="".concat(p.kh.qfferAPI,"/customer/web/signUp/email/store-info/").concat(e);try{return s=await X(a)}catch(e){return console.log(e),s}},z=(e,s)=>{Z({title:e,message:s}),R(!0)},J=async e=>{var s;let a=await G(e);if(console.log("resp: ",a),a&&"success"===a.message){console.log("resp: ",a);let e=!1;(null===(s=a.body.platform)||void 0===s?void 0:s.toLowerCase())==="qffer"&&(e=!0),P(e),L(!0),_(a.body)}else(null==a?void 0:a.message)&&"failure"===a.message&&a.body&&"Something went wrong"!=a.body?(console.log("error"),setTimeout(()=>{z("Invalid link",a.body)},300)):(console.log("error"),setTimeout(()=>{z("Invalid link","Oops! this link seems to be expired or broken, Please try again with another link.")},300))},M=async()=>{let e=window.location.href,a=await O(e);D(a),a.queries&&a.queries.amx&&(J(a.queries.amx),s(a.queries.amx))};return(0,r.useEffect)(()=>{M()},[]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(t(),{children:(0,l.jsx)("title",{children:"Qffer | Password Reset"})}),I?(0,l.jsx)(n.Z,{type:x?"QFFER":"GENERIC",logo:null==V?void 0:V.logo,brandColor:null==V?void 0:V.brandColor,children:y?(0,l.jsx)(g.Z,{user:S,storeId:e,handleSuccess:()=>{let e=S.accessToken,s={...S,signupUrl:a};U(e,s),W(s,e),window.location.href="/user/overview"},token:null==S?void 0:S.accessToken}):j?(0,l.jsx)(b.Z,{authType:"LOGIN",user:k,handleSuccess:e=>{console.log("handle OTP Sucess",e),A(e),q(!0)},storeId:e}):(0,l.jsx)(h.Z,{storeId:e,handleSuccess:e=>{E(e),N(!0)},signupUrl:a,loginUrl:f,isForgotPassword:!0})}):(0,l.jsx)(w.Z,{removePreloader:I,loaderType:"GENERIC"}),(0,l.jsx)(m.Z,{isVisible:C,handleBackdropClick:()=>{},title:null==T?void 0:T.title,message:null==T?void 0:T.message})]})}}},function(e){e.O(0,[1664,3582,6211,8248,9774,2888,179],function(){return e(e.s=9021)}),_N_E=e.O()}]);